function commandOptions(){"use strict";var e={indent:Number,maxerr:Number,maxlen:Number,predef:[String,Array],edition:String,config:String},r=["ass","bitwise","browser","closure","continue","debug","devel","eqeq","evil","forin","newcap","node","nomen","passfail","plusplus","properties","regexp","rhino","unparam","sloppy","stupid","sub","todo","vars","white"],o=["json","color","terse","version","filter"],n=["anon","es5","on","undef","windows"],t=r.concat(o).concat(n);return t.forEach(function(r){e[r]=Boolean}),e}function die(e){"use strict";var r=commandOptions();con.warn(e),con.warn("Usage: "+pro.argv[1]+" [--"+Object.keys(r).sort().join("] [--")+"] [--] <scriptfile>..."),exit(1)}function parseArgs(e){"use strict";var r=nopt(commandOptions(),{},e);return void 0===r.filter&&(r.filter=!0),r}function expandGlob(e){"use strict";return function(r){return e.sync(r)}}function noNodeModules(e){"use strict";return e.indexOf("node_modules")===-1}function flatten(e,r){"use strict";return e.concat(r)}function globFiles(e,r,o){"use strict";var n=[];return n=e.map(expandGlob(r)).reduce(flatten,[]),o&&(n=n.filter(noNodeModules)),n}function makeReporter(e){"use strict";var r;return r=e.json?new JSONReportStream(e):e.collector?new CollectorStream(e):new ReportStream(e),r.on("data",function(e){"."===e?pro.stderr.write(e):con.log(e)}),r}var nodelint=require("./nodelint"),optModule=require("./options"),nopt=require("nopt"),exit=require("exit"),glob=require("glob"),LintStream=require("./lintstream.js"),ReportStream=require("./reportstream.js"),CollectorStream=require("./collectorstream.js"),JSONReportStream=require("./jsonreportstream.js"),FileOpener=require("./fileopener.js"),con=console,pro=process;exports.setConsole=function(e){"use strict";con=e},exports.setProcess=function(e){"use strict";pro=e,exit=pro.exit.bind(pro)},exports.commandOptions=commandOptions,exports.parseArgs=parseArgs,exports.reportVersion=function(e,r){"use strict";process.nextTick(function(){var o=require("../package.json"),n=o.version,t=nodelint.load(r.edition).edition;e("node-jslint version: "+n+"  JSLint edition "+t)})},exports.expandGlob=expandGlob,exports.noNodeModules=noNodeModules,exports.globFiles=globFiles,exports.makeReporter=makeReporter,exports.runMain=function(e,r){"use strict";if(e.version)return void exports.reportVersion(con.log,e);e.argv.remain.length||die("No files specified.");var o=optModule.getOptions(process.env.HOME,e),n=globFiles(e.argv.remain,glob,e.filter),t=new FileOpener,i=new LintStream(o),s=makeReporter(o);t.pipe(i),i.pipe(s),s.on("finish",function(){return r?r(null,s.lint):s.allOK?exit(0):void exit(1)}),n.forEach(function(e){t.write(e)}),t.end()};