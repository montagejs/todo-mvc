var Montage=require("../core").Montage,Point=exports.Point=Montage.specialize({init:{enumerable:!1,value:function(t,e){return this.x=null===t?0:t,this.y=null===e?0:e,this}},x:{enumerable:!0,value:0},y:{enumerable:!0,value:0}},{interpolate:{enumerable:!1,value:function(t,e,n,o){var i,r;return i=e.x+(n.x-e.x)*t,r=e.y+(n.y-e.y)*t,o>0&&(i=Math.round(i*o)/o,r=Math.round(r*o)/o),(new exports.Point).init(i,r)}}}),_offsetForElement=function(t){var e,n,o,i,r=t.ownerDocument;if(t&&r){if(n=r.documentElement,o=r.body,i=r.defaultView,t!==o){if(e=t.getBoundingClientRect(),n.parentOf(t)){var l=n.clientTop||o.clientTop||0,f=n.clientLeft||o.clientLeft||0,u=i.pageYOffset||n.scrollTop||o.scrollTop,P=i.pageXOffset||n.scrollLeft||o.scrollLeft,a=e.top+u-l,c=e.left+P-f;return{top:a,left:c}}return{top:e.top,left:e.left}}return{top:o.offsetTop,left:o.offsetLeft}}return null},_webKitPoint=null,webkitImplementation=function(){Point.convertPointFromNodeToPage=function(t,e){return e?(_webKitPoint.x=e.x,_webKitPoint.y=e.y):(_webKitPoint.x=0,_webKitPoint.y=0),e=webkitConvertPointFromNodeToPage(t,_webKitPoint),e?(new Point).init(e.x,e.y):null},Point.convertPointFromPageToNode=function(t,e){return e?(_webKitPoint.x=e.x,_webKitPoint.y=e.y):(_webKitPoint.x=0,_webKitPoint.y=0),e=webkitConvertPointFromPageToNode(t,_webKitPoint),e?(new Point).init(e.x,e.y):null}},shimImplementation=function(){Point.convertPointFromNodeToPage=function(t,e){if(!t||"undefined"!=typeof t.x)return null;var n;return(n=_offsetForElement(t))?(new Point).init((e?e.x:0)+n.left,(e?e.y:0)+n.top):(new Point).init(e?e.x:0,e?e.y:0)},Point.convertPointFromPageToNode=function(t,e){if(!t||"undefined"!=typeof t.x)return null;var n;return(n=_offsetForElement(t))?(new Point).init((e?e.x:0)-n.left,(e?e.y:0)-n.top):(new Point).init(e?e.x:0,e?e.y:0)}};"undefined"!=typeof WebKitPoint?(_webKitPoint=new WebKitPoint(0,0),webkitImplementation()):shimImplementation();