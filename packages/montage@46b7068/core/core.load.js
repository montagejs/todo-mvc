montageDefine("46b7068","core/core",{dependencies:["collections/shim","./shim/object","./shim/array","./extras/object","./extras/date","./extras/element","./extras/function","./extras/regexp","./extras/string","collections/map","collections/weak-map","collections/set","collections/listen/property-changes","frb","frb/parse","frb/evaluate","frb/assign","frb/bind","frb/compile-observer","frb/scope","frb/observers","./serialization/bindings","./promise"],factory:function(e,t,r){function n(){var e="";return this===Function||this===Function.prototype.constructor?e="Function":this!==Function.prototype&&(e=(""+this).replace(L,"").replace(z,"")),e}function o(e,t,r){var n=r||(t===P?V:h+t+b);return e!==Object.prototype?e.hasOwnProperty(n)?e[n]:Object.defineProperty(e,n,{enumerable:!1,configurable:!1,writable:!0,value:Object.create(o(Object.getPrototypeOf(e),t,n))})[n]:(R.has(t)||R.set(t,{}),R.get(t))}function i(e){var t=i&&i.caller?i.caller:arguments.callee.caller,r=p.call(this,t,e,!0,!1,!1),n=this;return r?function(){return r.apply(n,arguments)}:Function.noop}function a(e){var t=a&&a.caller?a.caller:arguments.callee.caller,r=p.call(this,t,e,!1,!0,!1),n=this;return r?function(){return r.apply(n,arguments)}:Function.noop}function c(e){var t=c&&c.caller?c.caller:arguments.callee.caller,r=p.call(this,t,e,!1,!1,!0),n=this;return r?function(){return r.apply(n,arguments)}:Function.noop}function l(){var e=l&&l.caller?l.caller:arguments.callee.caller,t=p.call(this,e);return t?t.apply(this,arguments):void 0}function s(e){var t=_superDependenciesWeakMap.get(e);return t||_superDependenciesWeakMap.set(e,t=new F),t}function u(e){var t=T.get(e);return t||T.set(e,t=new F),t}function p(e,t,r,n,o){if(e||t){var i=M.get(e);if(!i){var a=typeof this===O;i=d(e,a?this:this.constructor,a,t,r,n,o),i&&(M.set(e,i),u(i).add(e))}return i}}function f(e,t,r){var n,o,i,a=M,c=Object.getOwnPropertyDescriptor(e,t);if(c)if(typeof c.value===O&&typeof r.value===O)for(a["delete"](c.value),n=u(c.value),o=n.values();i=o.next().value;)a["delete"](i);else{if(typeof c.get===O&&typeof r.get===O)for(a["delete"](c.get),n=u(c.get),o=n.values();i=o.next().value;)a["delete"](i);if(typeof c.set===O&&typeof r.set===O)for(a["delete"](c.set),n=u(c.set),o=n.values();i=o.next().value;)a["delete"](i)}if(n=_superDependenciesWeakMap.get(e))for(o=n.values();i=o.next().value;)f(i,t,r)}function d(e,t,r,n,o,i,a){var c,l,u,p,f,d,b,h,g,y,v=global.Object,m=o,P=i,j=a;for(b=g=r?t:t.prototype;!y&&null!==g;){if(d){if(p=v.getOwnPropertyDescriptor(g,d)){if(p.hasOwnProperty("value")){f=p.value,y=!0;break}if(P&&p.hasOwnProperty("get")){f=p.get,y=!0;break}if(j&&p.hasOwnProperty("set")){f=p.set,y=!0;break}}}else for(c=n?(W[0]=n)&&W:v.getOwnPropertyNames(g),l=0;u=c[l];l++)if(p=v.getOwnPropertyDescriptor(g,u))if(null!=(f=p.value)){if(f===e||f.deprecatedFunction===e){d=u,m=!0;break}}else{if(null!=(f=p.get)&&(f===e||f.deprecatedFunction===e)){d=u,P=!0;break}if(null!=(f=p.set)&&(f===e||f.deprecatedFunction===e)){d=u,j=!0;break}}h=g,(g=v.getPrototypeOf(g))&&s(g).add(h)}return y&&typeof f===O?f:Function.noop}e("collections/shim"),e("./shim/object"),e("./shim/array"),e("./extras/object"),e("./extras/date"),e("./extras/element"),e("./extras/function"),e("./extras/regexp"),e("./extras/string");var b="AttributeProperties",h="_",g="__proto__",y="value",v="enumerable",m="distinct",P="serializable",O="function",j=95,_=Array.prototype,w=(Object.prototype,{get:void 0,set:void 0,configurable:!1,enumerable:!1}),D={value:void 0,configurable:!1,enumerable:!1,writable:!1},C=e("collections/map"),I=e("collections/weak-map"),F=e("collections/set"),M=new I;if(_superDependenciesWeakMap=new I,!Object.create.name){var L=/^[\S\s]*?function\s*/,z=/[\s\(\/][\S\s]+$/;Object.defineProperty(Function.prototype,"name",{get:n})}var x=t.Montage=function(){},B={}.__proto__===Object.prototype,A={_montage_metadata:1,__state__:1,_hasUserDefinedConstructor:1};if(x.defineValueProperty=function ie(e,t,r,n,o,i){ie.template.value=r,ie.template.configurable=n,ie.template.enumerable=o,ie.template.writable=i,this.defineProperty(e,t,ie.template)},x.defineValueProperty.template=D,x.defineAccessorProperty=function ae(e,t,r,n,o,i){ae.template.get=r,ae.template.set=n,ae.template.configurable=o,ae.template.enumerable=i,this.defineProperty(e,t,Montage_defineValueProperty.template)},x.defineAccessorProperty.template=w,D.value=!1,Object.defineProperty(x,"_hasUserDefinedConstructor",D),D.value=function(e,t){var r,n,o,i,a,c,l,s=this,u="undefined"==typeof this.specialize;if(e=e||Object.empty,t=t||Object.empty,e.constructor&&e.constructor.value?(r=e.constructor.value,r._hasUserDefinedConstructor=!0):this._hasUserDefinedConstructor?r=function(){return this["super"]()||this}:(r=function(){return this},r.name=this.name+"Specialized"),B)r.__proto__=s;else{for(o=Object.getOwnPropertyNames(s),c=0,l=o.length;c<l;c++)i=o[c],A.hasOwnProperty(i)||(a=Object.getOwnPropertyDescriptor(r,i),a&&!a.configurable||x.defineProperty(r,i,Object.getOwnPropertyDescriptor(s,i)));r.__constructorProto__=s,x.defineProperty(r,"isPrototypeOf",{value:function(e){for(var t;null!==e;){if(t=Object.getPrototypeOf(e),t===this)return!0;e=t}return!1},enumerable:!1})}if(n=Object.create(this.prototype),u){for(o=Object.getOwnPropertyNames(x),c=0,l=o.length;c<l;c++)i=o[c],a=Object.getOwnPropertyDescriptor(r,i),a&&!a.configurable||x.defineProperty(r,i,Object.getOwnPropertyDescriptor(x,i));for(o=Object.getOwnPropertyNames(x.prototype),c=0,l=o.length;c<l;c++)i=o[c],a=Object.getOwnPropertyDescriptor(r,i),a&&!a.configurable||x.defineProperty(n,i,Object.getOwnPropertyDescriptor(x.prototype,i))}return"objectDescriptor"in e&&x.defineProperty(r,"objectDescriptor",e.objectDescriptor),"blueprint"in e&&x.defineProperty(r,"blueprint",e.blueprint),"objectDescriptorModuleId"in e&&x.defineProperty(r,"objectDescriptorModuleId",e.objectDescriptorModuleId),"blueprintModuleId"in e&&x.defineProperty(r,"blueprintModuleId",e.blueprintModuleId),x.defineProperties(n,e,!0),x.defineProperties(r,t,!0),x.defineProperty(r,"__isConstructor__",{value:!0,enumerable:!1}),r.prototype=n,x.defineValueProperty(n,"constructor",r,!0,!1,!0),x.defineValueProperty(r,"constructor",r,!0,!1,!0),r},D.writable=!1,D.configurable=!0,D.enumerable=!1,Object.defineProperty(x,"specialize",D),!B){var k=Object.getPrototypeOf;Object.getPrototypeOf=function(e){return typeof e===O&&e.__constructorProto__?e.__constructorProto__:k.apply(Object,arguments)}}D.writable=D.configurable=D.enumerable=!1,D.value=function(e,t,r,n){if("object"!=typeof e&&typeof e!==O||null===e)throw new TypeError("Object must be an object, not '"+e+"'");var i=y in r;if(m in r&&!i)throw new TypeError("Cannot use distinct attribute on non-value property '"+t+"'");if(g in r)r.__proto__=i?typeof r.value===O?S:N:E;else{var a;a=i?typeof r.value===O?S:N:E;for(var c in a)c in r||(r[c]=a[c])}return r.hasOwnProperty(v)||t.charCodeAt(0)!==j||(r.enumerable=!1),r.hasOwnProperty(P)||(r.enumerable?r.get&&!r.set?r.serializable=!1:r.writable===!1&&(r.serializable=!1):r.serializable=!1),P in r&&(o(e,P)[t]=r.serializable),n||f(e,t,r),Object.defineProperty(e,t,r)},Object.defineProperty(x,"defineProperty",D),Object.defineProperty(x,"defineProperties",{value:function(e,t,r){if("object"!=typeof t||null===t)throw new TypeError("Properties must be an object, not '"+t+"'");for(var n=Object.getOwnPropertyNames(t),o=0;property=n[o];o++)"_bindingDescriptors"!==property&&this.defineProperty(e,property,t[property],r);return e}});var E={enumerable:!0,configurable:!0,serializable:!0},N={writable:!0,enumerable:!0,configurable:!0,serializable:"reference"},S={writable:!0,enumerable:!1,configurable:!0},V="_serializableAttributeProperties";Object.defineProperty(x.prototype,V,{enumerable:!1,configurable:!1,writable:!0,value:{}});var R=new C;x.defineProperty(x,"didCreate",{value:Function.noop});var T=new C,W=[];x.defineProperty(x,"super",{value:l,enumerable:!1}),x.defineProperty(x.prototype,"super",{value:l,enumerable:!1}),x.defineProperty(x,"superForValue",{value:i,enumerable:!1}),x.defineProperty(x.prototype,"superForValue",{value:i,enumerable:!1}),x.defineProperty(x,"superForGet",{value:a,enumerable:!1}),x.defineProperty(x.prototype,"superForGet",{value:a,enumerable:!1}),x.defineProperty(x,"superForSet",{value:c,enumerable:!1}),x.defineProperty(x.prototype,"superForSet",{value:c,enumerable:!1}),x.defineProperty(x,"getSerializablePropertyNames",{value:function(e){var t,r=o(e,P);if(r){t=[];for(var n in r)r[n]&&t.push(n);return t}return Array.empty}}),x.defineProperty(x,"getPropertyAttribute",{value:function(e,t,r){var n=o(e,r);if(n)return n[t]}}),x.defineProperty(x,"getPropertyAttributes",{value:function(e,t){var r,n=o(e,t);if(n){r={};for(var i in n)r[i]=n[i];return r}}});var q={isInstance:{value:!0}},J={objectName:{value:"Function"},isInstance:{value:!0}};Object.defineProperty(x.prototype,"_montage_metadata",{enumerable:!1,writable:!0,value:void 0}),x.defineProperty(x,"getInfoForObject",{value:function(e){var t,r;if(U.call(e,"_montage_metadata")&&e._montage_metadata)return e._montage_metadata;if(t=e._montage_metadata||e.constructor&&e.constructor._montage_metadata||null,r=e.constructor===Function?J:q,e===Object.prototype)return Object.create(t,r);try{return e.constructor===Object?Object.defineProperty(e,"_montage_metadata",{enumerable:!1,writable:!0,value:Object.create(t,r)})._montage_metadata:("_montage_metadata"in e.constructor.prototype||Object.defineProperty(e.constructor.prototype,"_montage_metadata",{enumerable:!1,writable:!0,value:void 0}),(e._montage_metadata=Object.create(t,r))||e._montage_metadata)}catch(n){return e._montage_metadata=Object.create(t,r)}}});var U=Object.prototype.hasOwnProperty;x.defineProperty(x,"identifier",{value:null,serializable:!0}),x.defineProperty(x.prototype,"identifier",{value:null,serializable:!0}),x.defineProperty(x.prototype,"equals",{value:function(e){return!!e&&(this===e||this.uuid&&this.uuid===e.uuid)}}),x.defineProperty(x,"equals",{value:x.prototype.equals}),x.defineProperty(x.prototype,"callDelegateMethod",{value:function(e){var t,r=this.delegate;if(r&&("string"==typeof this.identifier&&typeof(t=r[this.identifier+e.toCapitalized()])===O||typeof(t=r[e])===O,t))return 2===arguments.length?t.call(r,arguments[1]):3===arguments.length?t.call(r,arguments[1],arguments[2]):4===arguments.length?t.call(r,arguments[1],arguments[2],arguments[3]):5===arguments.length?t.call(r,arguments[1],arguments[2],arguments[3],arguments[4]):(_.shift.call(arguments),t.apply(r,arguments))}});var G=e("collections/listen/property-changes");Object.addEach(x,G.prototype),Object.addEach(x.prototype,G.prototype);var H=t.Bindings=e("frb"),X={defineBinding:{value:function(e,t,r){return H.defineBinding(this,e,t,r)}},defineBindings:{value:function(e,t){return H.defineBindings(this,e,t)}},cancelBinding:{value:function(e){return H.cancelBinding(this,e)}},cancelBindings:{value:function(){return H.cancelBindings(this)}},getBinding:{value:function(e){return H.getBinding(this,e)}},getBindings:{value:function(){return H.getBindings(this)}}};x.defineProperties(x,X),x.defineProperties(x.prototype,X);var $=e("frb/parse"),K=e("frb/evaluate"),Q=e("frb/assign"),Y=(e("frb/bind"),e("frb/compile-observer")),Z=e("frb/scope"),ee=e("frb/observers"),te=ee.autoCancelPrevious,re=function(){return this._willChangeListeners=null,this._changeListeners=null,this};Object.defineProperties(re.prototype,{_willChangeListeners:{value:null,writable:!0},willChangeListeners:{get:function(){return this._willChangeListeners||(this._willChangeListeners=new C)}},_changeListeners:{value:null,writable:!0},changeListeners:{get:function(){return this._changeListeners||(this._changeListeners=new C)}}});var ne=new I,oe={getPath:{value:function(e,t,r,n){return K(e,this,t||this,r,n)}},setPath:{value:function(e,t,r,n,o){return Q(this,e,t,r||this,n,o)}},observePath:{value:function(e,t){var r=$(e),n=Y(r);return n(te(t),new Z(this))}},addRangeAtPathChangeListener:{value:function(e,t,r,n,o,i){function a(e,n,o){if(t[r])t[r](e,n,o);else{if(!t.call)throw new Error("Can't dispatch range change to "+t);t.call(null,e,n,o)}}r=r||"handleRangeChange";var c=[];return this.addPathChangeListener(e,function(e){return e&&e.toArray&&e.addRangeChangeListener?(a(e.toArray(),c.toArray(),0),c=e,e.addRangeChangeListener(a)):(e=[],a(e,c,0),c=e,void 0)},void 0,void 0,n,o,i)}},getPathChangeDescriptors:{value:function(){return ne.has(this)||ne.set(this,new C),ne.get(this)}},getPathChangeDescriptor:{value:function(e,t,r){var n=x.getPathChangeDescriptors.call(this);return n.has(e)||n.set(e,new re),n=n.get(e),n=r?n.willChangeListeners:n.changeListeners,n.has(t)||n.set(t,{path:e,handler:t,beforeChange:r,cancel:Function.noop}),n.get(t)}},addPathChangeListener:{value:function(e,t,r,n,o,i,a){var c=this;t=t||Function.noop;var l=x.getPathChangeDescriptor.call(this,e,t,n);l.cancel();var s,u,p,f=$(e);if(t===Function.noop)p=function(t){if(u)throw new Error("Path change handler needs a handler because it emits new values when the source changes: "+JSON.stringify(e));u=!0,s=t};else if(r)p=function(n){return t[r].call(t,n,e,c)};else if(t.handlePathChange)p=function(r){return t.handlePathChange.call(t,r,e,c)};else{if(typeof t!==O)throw new Error("Can't recognize handler type: "+t+". Must be function or delegate implementing handlePathChange.");p=function(r){return t.call(c,r,e,c)}}var d=Y(f),b=new Z(this);b.beforeChange=n,b.parameters=o,b.document=i,b.components=a;var h=d(te(p),b);return l.cancel=h,u?s:h}},removePathChangeListener:{value:function(e,t,r){t=t||Function.noop;var n=x.getPathChangeDescriptors.call(this),o=r?"willChangeListeners":"changeListeners",i=n.get(e);if(!i)throw new Error("Can't find "+o+" for "+JSON.stringify(e));var a=i[o];if(!a.has(t))throw new Error("Can't find "+o+" for "+JSON.stringify(e));var c=a.get(t);c.cancel(),a["delete"](t),0===i.willChangeListeners.size&&0===i.changeListeners.size&&n["delete"](e),n.size<1&&ne["delete"](this)}},addBeforePathChangeListener:{value:function(e,t,r,n,o,i){return x.addPathChangeListener.call(this,e,t,r,!0,n,o,i)}},removeBeforePathChangeListener:{value:function(e,t,r){return x.removePathChangeListener.call(this,e,t,!0)}}};x.defineProperties(x,oe),x.defineProperties(x.prototype,oe),e("./serialization/bindings"),t._objectDescriptorModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var e=x.getInfoForObject(this),t=e&&!e.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(t,"_objectDescriptorModuleId")||!t._objectDescriptorModuleId){e=x.getInfoForObject(t);var r=e.moduleId,n=r.lastIndexOf("/"),o=r.lastIndexOf(".");n=n===-1?0:n+1,o=o===-1?r.length:o,o=o<n?r.length:o,x.defineProperty(t,"_objectDescriptorModuleId",{enumerable:!1,value:r.slice(0,o)+".mjson"})}return t._objectDescriptorModuleId}},t._blueprintModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var e=x.getInfoForObject(this),t=e&&!e.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(t,"_objectDescriptorModuleId")||!t._objectDescriptorModuleId){e=x.getInfoForObject(t);var r=e.moduleId,n=r.lastIndexOf("/"),o=r.lastIndexOf(".");n=n===-1?0:n+1,o=o===-1?r.length:o,o=o<n?r.length:o,x.defineProperty(t,"_objectDescriptorModuleId",{enumerable:!1,value:r.slice(0,o)+".meta"})}return t._objectDescriptorModuleId}},t._objectDescriptorDescriptor={serializable:!1,enumerable:!1,get:function(){var r=x.getInfoForObject(this),n=r&&!r.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(n,"_objectDescriptor")||!n._objectDescriptor){var o=n.objectDescriptorModuleId||n.blueprintModuleId;if(!o)throw new TypeError("ObjectDescriptor moduleId undefined for the module '"+JSON.stringify(n)+"'");t._objectDescriptorDescriptor.ObjectDescriptorModulePromise||(t._objectDescriptorDescriptor.ObjectDescriptorModulePromise=e.async("core/meta/module-object-descriptor").get("ModuleObjectDescriptor")),x.defineProperty(n,"_objectDescriptor",{enumerable:!1,value:t._objectDescriptorDescriptor.ObjectDescriptorModulePromise.then(function(e){var t=x.getInfoForObject(n);return e.getObjectDescriptorWithModuleId(o,t.require)["catch"](function(t){if(t.message.indexOf("Can't XHR")!==-1)return e.createDefaultObjectDescriptorForObject(n).then(function(e){return e});throw t})})})}return n._objectDescriptor},set:function(t){var r,n=x.getInfoForObject(this),o=n&&!n.isInstance?this:this.constructor;if(null===t)r=null;else{if(typeof t.then===O)throw new TypeError("Object descriptor should not be a promise");t.objectDescriptorInstanceModule=o.objectDescriptorModule,r=e("./promise").Promise.resolve(t)}x.defineProperty(o,"_objectDescriptor",{enumerable:!1,value:r})}},t._blueprintDescriptor=t._objectDescriptorDescriptor}});