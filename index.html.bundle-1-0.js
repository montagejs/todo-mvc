montageDefine("42551f5","ui/main.reel/main.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><title>Main</title><style>.main,.footer,.clear-completed{display:none}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"mainComponent"},"_newTodoForm":{"#":"newTodoForm"},"_newTodoInput":{"#":"newTodoField"},"_filterController":{"@":"filterController"}},"bindings":{"selectedFilter":{"<-":"@filterController.value"}}},"todoRepetition":{"prototype":"montage/ui/repetition.reel","properties":{"element":{"#":"todo-list"}},"bindings":{"contentController":{"<-":"@owner.todoListController"}}},"todoView":{"prototype":"ui/todo-view.reel","properties":{"element":{"#":"todoView"}},"bindings":{"todo":{"<-":"@todoRepetition:iteration.object"}}},"main":{"prototype":"matte/ui/dynamic-element.reel","properties":{"element":{"#":"main"}},"bindings":{"classList.has(\'visible\')":{"<-":"@owner.todos.length > 0"}}},"footer":{"prototype":"matte/ui/dynamic-element.reel","properties":{"element":{"#":"footer"}},"bindings":{"classList.has(\'visible\')":{"<-":"@owner.todos.length > 0"}}},"toggleAllCheckbox":{"prototype":"native/ui/input-checkbox.reel","properties":{"element":{"#":"toggle-all"}},"bindings":{"checked":{"<->":"@owner.allCompleted"}}},"todoCount":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"todo-count"}},"bindings":{"value":{"<-":"@owner.todosLeft.length"}}},"todoCountWording":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"todo-count-wording"}},"bindings":{"value":{"<-":"@owner.todosLeft.length == 1 ? \'item\' : \'items\'"}}},"clearCompletedButton":{"prototype":"native/ui/button.reel","properties":{"element":{"#":"clear-completed"}},"listeners":[{"type":"action","listener":{"@":"owner"},"capture":false}],"bindings":{"classList.has(\'visible\')":{"<-":"@owner.todosCompleted.length"}}},"filterController":{"prototype":"montage/core/radio-button-controller","properties":{"value":"all"}},"filterAll":{"prototype":"core/radio-button","properties":{"element":{"#":"filter-all"},"radioButtonController":{"@":"filterController"},"value":"all"},"bindings":{"classList.has(\'selected\')":{"<-":"@filterAll.checked"}}},"filterActive":{"prototype":"core/radio-button","properties":{"element":{"#":"filter-active"},"radioButtonController":{"@":"filterController"},"value":"active"},"bindings":{"classList.has(\'selected\')":{"<-":"@filterActive.checked"}}},"filterCompleted":{"prototype":"core/radio-button","properties":{"element":{"#":"filter-completed"},"radioButtonController":{"@":"filterController"},"value":"completed"},"bindings":{"classList.has(\'selected\')":{"<-":"@filterCompleted.checked"}}}}</script></head><body><div data-montage-id=mainComponent><section class=todoapp><header class=header><h1>todos</h1><form data-montage-id=newTodoForm><input data-montage-id=newTodoField class=new-todo placeholder="What needs to be done?" autofocus=""></form></header><section data-montage-id=main class=main><input data-montage-id=toggle-all id=toggle-all class=toggle-all type=checkbox><label for=toggle-all>Mark all as complete</label><ul data-montage-id=todo-list class=todo-list><li data-montage-id=todoView></li></ul></section><footer data-montage-id=footer class=footer><span class=todo-count><strong data-montage-id=todo-count>0</strong> <span data-montage-id=todo-count-wording>items</span> left</span><ul class=filters><li><a data-montage-id=filter-all href=#/ >All</a></li><li><a data-montage-id=filter-active href=#/active>Active</a></li><li><a data-montage-id=filter-completed href=#/completed>Completed</a></li></ul><button data-montage-id=clear-completed class=clear-completed>Clear completed</button></footer></section><footer class=info><p>Double-click to edit a todo</p><p>Created with <a href=http://github.com/montagejs/montage>Montage</a></p><p>Source available at <a href=http://github.com/montagejs/todo-mvc>Montage-TodoMVC</a></p><p>Part of <a href=http://todomvc.com>TodoMVC</a></p></footer></div></body></html>'}),montageDefine("99ff7d6","ui/button.reel/button",{dependencies:["ui/native-control","montage/composer/press-composer","montage/collections/dict"],factory:function(e,t,o){var n=e("ui/native-control").NativeControl,i=e("montage/composer/press-composer").PressComposer,l=e("montage/collections/dict"),s=t.Button=n.specialize({_preventFocus:{enumerable:!1,value:!1},preventFocus:{get:function(){return this._preventFocus},set:function(e){e===!0?this._preventFocus=!0:this._preventFocus=!1}},enabled:{dependencies:["disabled"],get:function(){return!this._disabled},set:function(e){this.disabled=!e}},converter:{value:null},_labelNode:{value:void 0,enumerable:!1},_label:{value:void 0,enumerable:!1},label:{get:function(){return this._label},set:function(e){if(e&&e.length>0&&this.converter)try{e=this.converter.convert(e),this.error&&(this.error=null)}catch(t){this.error=t}this._label=e,this._isInputElement&&(this._value=e),this.needsDraw=!0}},setLabelInitialValue:{value:function(e){void 0===this._label&&(this._label=e)}},holdThreshold:{get:function(){return this._pressComposer.longPressThreshold},set:function(e){this._pressComposer.longPressThreshold=e}},_pressComposer:{enumberable:!1,value:null},_active:{enumerable:!1,value:!1},active:{get:function(){return this._active},set:function(e){this._active=e,this.needsDraw=!0}},blur:{value:function(){this._element.blur()}},focus:{value:function(){this._element.focus()}},constructor:{value:function(){this["super"](),this._pressComposer=new i,this._pressComposer.longPressThreshold=this.holdThreshold,this.addComposer(this._pressComposer)}},prepareForActivationEvents:{value:function(){this._pressComposer.addEventListener("pressStart",this,!1),this._pressComposer.addEventListener("press",this,!1),this._pressComposer.addEventListener("pressCancel",this,!1)}},addEventListener:{value:function(e,t,o){this["super"](e,t,o),"hold"===e&&this._pressComposer.addEventListener("longPress",this,!1)}},handlePressStart:{value:function(e){this.active=!0,e.touch&&document.addEventListener("touchmove",this,!1),this._preventFocus||this._element.focus()}},handlePress:{value:function(e){this.active=!1,this._dispatchActionEvent(),document.removeEventListener("touchmove",this,!1)}},handleKeyup:{value:function(e){32===e.keyCode&&(this.active=!1,this._dispatchActionEvent())}},handleLongPress:{value:function(e){this._pressComposer.cancelPress();var t=document.createEvent("CustomEvent");t.initCustomEvent("hold",!0,!0,null),this.dispatchEvent(t)}},handlePressCancel:{value:function(e){this.active=!1,document.removeEventListener("touchmove",this,!1)}},handleTouchmove:{value:function(e){e.preventDefault()}},_isInputElement:{value:!1,enumerable:!1},enterDocument:{value:function(e){n.enterDocument&&n.enterDocument.apply(this,arguments),e&&(this._isInputElement="INPUT"===this.originalElement.tagName,this._isInputElement?(Object.defineProperty(this,"value",{get:function(){return this._label},set:function(e){this.label=e}}),void 0===this._label&&(this._label=this.originalElement.value)):(this.originalElement.firstChild||this.originalElement.appendChild(document.createTextNode("")),this._labelNode=this.originalElement.firstChild,this.setLabelInitialValue(this._labelNode.data),void 0===this._label&&(this._label=this._labelNode.data)),this.element.setAttribute("role","button"),this.element.addEventListener("keyup",this,!1))}},_drawLabel:{enumerable:!1,value:function(e){this._isInputElement?this._element.setAttribute("value",e):this._labelNode.data=e}},draw:{value:function(){this["super"](),this._disabled?this._element.classList.add("disabled"):this._element.classList.remove("disabled"),this._active?this._element.classList.add("active"):this._element.classList.remove("active"),this._drawLabel(this.label)}},_detail:{value:null},detail:{get:function(){return null===this._detail&&(this._detail=new l),this._detail}},createActionEvent:{value:function(){var e,t=document.createEvent("CustomEvent");return e=this._detail,t.initCustomEvent("action",!0,!0,e),t}}});s.addAttributes({autofocus:{value:!1,dataType:"boolean"},disabled:{value:!1,dataType:"boolean"},form:null,formaction:null,formenctype:null,formmethod:null,formnovalidate:{dataType:"boolean"},formtarget:null,type:{value:"button"},name:null,value:null})}}),montageDefine("42551f5","ui/main.reel/main",{dependencies:["montage/ui/component","montage/core/range-controller","core/todo","montage/core/serialization/serializer/montage-serializer","montage/core/serialization/deserializer/montage-deserializer"],factory:function(e,t,o){var n=e("montage/ui/component").Component,i=e("montage/core/range-controller").RangeController,l=e("core/todo").Todo,s=e("montage/core/serialization/serializer/montage-serializer").MontageSerializer,a=e("montage/core/serialization/deserializer/montage-deserializer").MontageDeserializer,r="todos-montage";t.Main=n.specialize({_newTodoForm:{value:null},_newTodoInput:{value:null},todoListController:{value:null},constructor:{value:function(){this.todoListController=new i,this.addPathChangeListener("todos.every{completed}",this,"handleTodosCompletedChanged"),this.defineBindings({todos:{"<-":"todoListController.content"},todosLeft:{"<-":"todos.filter{!completed}"},todosCompleted:{"<-":"todos.filter{completed}"}})}},_selectedFilter:{value:null},selectedFilter:{set:function(e){if(this._selectedFilter!==e&&(this._selectedFilter=e,this.todoListController)){var t=null;e&&(t="active"===e?"!completed":"completed"===e?"completed":null),this.todoListController.filterPath=t}},get:function(){return this._selectedFilter}},templateDidLoad:{value:function(){this.load()}},load:{value:function(){if(localStorage){var t=localStorage.getItem(r);if(t){var o=new a,n=this;o.init(t,e).deserializeObject().then(function(e){n.todoListController.content=e},function(e){console.error("Could not load saved tasks."),console.debug("Could not deserialize",t),console.log(e.stack)})}}}},save:{value:function(){if(localStorage){var t=this.todoListController.content,o=(new s).initWithRequire(e);localStorage.setItem(r,o.serializeObject(t))}}},enterDocument:{value:function(e){if(e){if(this._newTodoForm.identifier="newTodoForm",this._newTodoForm.addEventListener("submit",this,!1),window.location&&window.location.hash){var t=window.location.hash.substring(2);"active"!==t&&"completed"!==t||(this._filterController.value=t)}this.addEventListener("destroyTodo",this,!0),window.addEventListener("beforeunload",this,!0)}}},captureDestroyTodo:{value:function(e){this.destroyTodo(e.detail.todo)}},createTodo:{value:function(e){var t=(new l).initWithTitle(e);return this.todoListController.add(t),t}},destroyTodo:{value:function(e){return this.todoListController["delete"](e),e}},_allCompleted:{value:null},allCompleted:{get:function(){return this._allCompleted},set:function(e){this._allCompleted=e,this.todoListController&&this.todoListController.content&&this.todoListController.content.forEach(function(t){t.completed=e})}},todos:{value:null},todosLeft:{value:null},todosCompleted:{value:null},handleNewTodoFormSubmit:{value:function(e){e.preventDefault();var t=this._newTodoInput.value.trim();""!==t&&(this.createTodo(t),this._newTodoInput.value=null)}},handleTodosCompletedChanged:{value:function(e){this._allCompleted=e,this.dispatchOwnPropertyChange("allCompleted",e)}},handleClearCompletedButtonAction:{value:function(){var e=this.todoListController.content.filter(function(e){return e.completed});e.length>0&&this.todoListController.deleteEach(e)}},captureBeforeunload:{value:function(){this.save()}}})}}),montageDefine("46b7068","composer/key-composer",{dependencies:["../core/core","./composer"],factory:function(e,t,o){var n=e("../core/core").Montage,i=e("./composer").Composer,l="keyPress",s="longKeyPress",a="keyRelease",r=t.KeyComposer=i.specialize({_shouldDispatchEvent:{value:!1},shouldDispatchLongPress:{value:!1},_longPressTimeout:{value:null},_keyRegistered:{value:!1},_keys:{value:null},keys:{get:function(){return this._keys},set:function(e){this._keyRegistered?(u.defaultKeyManager.unregisterKey(this),this._keys=e,u.defaultKeyManager.registerKey(this)):this._keys=e}},load:{value:function(){this._shouldDispatchEvent&&!this._keyRegistered&&(u.defaultKeyManager.registerKey(this),this._keyRegistered=!0)}},unload:{value:function(){u.defaultKeyManager.unregisterKey(this),this._keyRegistered=!1}},addEventListener:{value:function(e,t,o){var n=this.component;i.prototype.addEventListener.call(this,e,t,o),e!=l&&e!=s&&e!=a||(this._shouldDispatchEvent=!0,e==s&&(this._shouldDispatchLongPress=!0),this._isLoaded?this._keyRegistered||(u.defaultKeyManager.registerKey(this),this._keyRegistered=!0):n&&"function"!=typeof n.addComposer&&(this.element||(this.element=window),this.component.loadComposer(this)))}},deserializedFromTemplate:{value:function(){var e=this.component;null===this.identifier&&(this.identifier=n.getInfoForObject(this).label),e&&("function"==typeof e.addComposer?e.addComposer(this):this._isLoaded||(this.element||(this.element=window),this.component.loadComposer(this)))}}},{createKey:{value:function(e,t,o){var n=this;return this===r&&(n=new r),o||(o=e.identifier?e.identifier+t.toLowerCase().replace(/[ +]/g).toCapitalized():t.toLowerCase().replace(/[ +]/g)),n.keys=t,n.identifier=o,e.addComposer(n),n}},createGlobalKey:{value:function(e,t,o){var n=this;return this===r&&(n=new r),n.keys=t,n.identifier=o,e.addComposerForElement(n,window),n}}}),d=null,u=n.specialize({_defaultKeyManager:{value:null},_loadingDefaultKeyManager:{value:!1},_keysToRegister:{value:[]},registerKey:{value:function(t){var o=this;this._defaultKeyManager?this._defaultKeyManager.registerKey(t):(this._keysToRegister.push(t),this._loadingDefaultKeyManager||(this._loadingDefaultKeyManager=!0,e.async("core/event/key-manager").then(function(e){var t=o._defaultKeyManager=e.defaultKeyManager;o._keysToRegister.forEach(function(e){t.registerKey(e)}),o._keysToRegister.length=0})))}},unregisterKey:{value:function(e){this._defaultKeyManager&&this._defaultKeyManager.unregisterKey(e)}}},{defaultKeyManager:{get:function(){return d||(d=new u),this._defaultKeyManager?this._defaultKeyManager:d}}})}}),montageDefine("42551f5","ui/todo-view.reel/todo-view",{dependencies:["montage/ui/component"],factory:function(e,t,o){var n=e("montage/ui/component").Component;t.TodoView=n.specialize({todo:{value:null},editInput:{value:null},constructor:{value:function(){this.defineBinding("isCompleted",{"<-":"todo.completed"})}},enterDocument:{value:function(){this.element.addEventListener("dblclick",this,!1),this.element.addEventListener("blur",this,!0),this.element.addEventListener("submit",this,!1)}},exitDocument:{value:function(){this.element.removeEventListener("dblclick",this,!1),this.element.removeEventListener("blur",this,!0),this.element.removeEventListener("submit",this,!1)}},captureDestroyButtonAction:{value:function(){this.dispatchDestroy()}},dispatchDestroy:{value:function(){this.dispatchEventNamed("destroyTodo",!0,!0,{todo:this.todo})}},handleDblclick:{value:function(){this.isEditing=!0}},_isEditing:{value:!1},isEditing:{get:function(){return this._isEditing},set:function(e){e!==this._isEditing&&(e?this.classList.add("editing"):this.classList.remove("editing"),this._isEditing=e,this.needsDraw=!0)}},_isCompleted:{value:!1},isCompleted:{get:function(){return this._isCompleted},set:function(e){e!==this._isCompleted&&(e?this.classList.add("completed"):this.classList.remove("completed"),this._isCompleted=e,this.needsDraw=!0)}},captureBlur:{value:function(e){this.isEditing&&this.editInput.element===e.target&&this._submitTitle()}},handleSubmit:{value:function(e){this.isEditing&&(e.preventDefault(),this._submitTitle())}},_submitTitle:{value:function(){var e=this.editInput.value.trim();""===e?this.dispatchDestroy():this.todo.title=e,this.isEditing=!1}},draw:{value:function(){this.isEditing?this.editInput.element.focus():this.editInput.element.blur()}}})}}),montageDefine("aa0acb4","ui/dynamic-element.reel/dynamic-element",{dependencies:["montage/ui/component"],factory:function(e,t,o){var n=e("montage/ui/component").Component;t.DynamicElement=n.specialize({hasTemplate:{value:!1},_innerHTML:{value:null},_usingInnerHTML:{value:null},innerHTML:{get:function(){return this._innerHTML},set:function(e){this._usingInnerHTML=!0,this._innerHTML!==e&&(this._innerHTML=e,this.needsDraw=!0)}},defaultHTML:{value:""},_allowedTagNames:{value:null},allowedTagNames:{get:function(){return this._allowedTagNames},set:function(e){this._allowedTagNames!==e&&(this._allowedTagNames=e,this.needsDraw=!0)}},_range:{value:null},enterDocument:{value:function(e){if(e){var t=document.createRange();this.element.className,t.selectNodeContents(this.element),this._range=t}}},_contentNode:{value:null},draw:{value:function(){var e,t,o=this.innerHTML||0===this.innerHTML?this.innerHTML:this.defaultHTML,n=this.allowedTagNames,i=this._range;i.selectNodeContents(this.element),this._usingInnerHTML&&(null!==n?(this._contentNode=null,i.deleteContents(),e=i.createContextualFragment(o),t=0!==n.length?e.querySelectorAll("*:not("+n.join("):not(")+")"):e.childNodes,0===t.length?(i.insertNode(e),0===i.endOffset&&i.selectNodeContents(this.element)):console.warn("Some Elements Not Allowed ",t)):(e=this._contentNode,null===e?(i.deleteContents(),this._contentNode=e=document.createTextNode(o),i.insertNode(e),0===i.endOffset&&i.selectNodeContents(this.element)):e.data=o))}}})}}),montageDefine("46b7068","composer/composer",{dependencies:["../core/target"],factory:function(e,t,o){var n=e("../core/target").Target;t.Composer=n.specialize({_component:{value:null},component:{get:function(){return this._component},set:function(e){this._component=e}},_element:{value:null},element:{get:function(){return this._element},set:function(e){this._element=e}},lazyLoad:{value:!0},_needsFrame:{value:!1},needsFrame:{set:function(e){this._needsFrame!==e&&(this._needsFrame=e,this._component&&e&&this._component.scheduleComposer(this))},get:function(){return this._needsFrame}},frame:{value:Function.noop},_resolveDefaults:{value:function(){this.element||null!=this.element||null==this.component||(this.element=this.component.element)}},_isLoaded:{value:!1},isLoaded:{get:function(){return this._isLoaded}},load:{value:Function.noop},unload:{value:Function.noop},deserializedFromTemplate:{value:function(){this.component&&this.component.addComposer(this)}}},{isCoordinateOutsideRadius:{value:function(e,t,o){return e*e+t*t>o*o}}})}}),montageDefine("99ff7d6","ui/native-control",{dependencies:["montage/ui/component"],factory:function(e,t,o){var n=e("montage/ui/component").Component,i=t.NativeControl=n.specialize({hasTemplate:{value:!1},willPrepareForDraw:{value:function(){}}});i.addAttributes({accesskey:null,contenteditable:null,contextmenu:null,dir:null,draggable:null,dropzone:null,hidden:{dataType:"boolean"},lang:null,spellcheck:null,style:null,tabindex:null,title:null})}}),montageDefine("42551f5","core/todo",{dependencies:["montage"],factory:function(e,t,o){var n=e("montage").Montage;t.Todo=n.specialize({constructor:{value:function(){this["super"]()}},initWithTitle:{value:function(e){return this.title=e,this}},title:{value:null},completed:{value:!1}})}});
bundleLoaded("index.html.bundle-1-0.js")